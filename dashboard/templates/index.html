<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plantomio Dashboard</title>
    <link rel="stylesheet" href="/static/css/styles.css">
    <link rel="stylesheet" href="/static/css/sidebar.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="/static/images/favicon.ico">
</head>
<body>
    <!-- Mobile menu toggle button -->
    <button class="mobile-toggle" id="mobile-toggle">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="3" y1="12" x2="21" y2="12"></line>
            <line x1="3" y1="6" x2="21" y2="6"></line>
            <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
    </button>

    <div class="app-wrapper">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                        <path d="M2 17l10 5 10-5"></path>
                        <path d="M2 12l10 5 10-5"></path>
                    </svg>
                </div>
            </div>
            <nav class="sidebar-nav">
                <ul>
                    <li><a href="/" class="active" title="Dashboard"><i class="fas fa-tachometer-alt"></i></a></li>
                    <li><a href="/trends" title="Trends"><i class="fas fa-chart-line"></i></a></li>
                    <li><a href="/settings" title="Settings"><i class="fas fa-cog"></i></a></li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <div class="main-content">
            <header class="main-header">
                <div class="header-content">
                    <h1>Plantomio Dashboard</h1>
                    <p class="subtitle">Plant monitoring system</p>
                </div>
                <div class="header-status">
                    <span class="status-indicator live">Live Data</span>
                    <span class="device-id">Device: <span id="device-id">pit-404cca470da0</span></span>
                    <span class="last-update">Last update: <span id="last-update">08:19:57</span></span>
                </div>
            </header>

            <div class="page-content">
                <!-- Plant Health and Tank Level Row -->
                <div class="health-tank-container">
                    <!-- Plant Health Assessment -->
                    <div class="health-content">
                        <div class="health-header">
                            <h2>Plant Health Assessment</h2>
                            <div class="health-actions">
                                <button class="btn btn-refresh">Refresh</button>
                                <button class="btn btn-actions">Actions</button>
                            </div>
                        </div>
                        <div class="health-status">
                            <div class="status-icon good">
                                <i class="fas fa-check"></i>
                            </div>
                            <div class="status-details">
                                <h3>Good Condition</h3>
                                <p>Based on sensor readings</p>
                            </div>
                        </div>
                        
                        <div class="health-metrics">
                            <div class="health-metric">
                                <label>Overall Health</label>
                                <div class="progress-container">
                                    <div class="progress-bar" style="width: 86%"></div>
                                </div>
                                <span class="progress-value">86%</span>
                            </div>
                            
                            <div class="health-metric">
                                <label>Water Quality</label>
                                <div class="progress-container">
                                    <div class="progress-bar water-quality" style="width: 62%"></div>
                                </div>
                                <span class="progress-value">62%</span>
                            </div>
                            
                            <div class="health-metric">
                                <label>Growth Rate</label>
                                <div class="progress-container">
                                    <div class="progress-bar growth-rate" style="width: 78%"></div>
                                </div>
                                <span class="progress-value">78%</span>
                            </div>
                        </div>
                        
                        <div class="recommendation-box">
                            <h4>Recommendation</h4>
                            <p>Consider reducing nutrient solution concentration. TDS levels are above optimal range for this plant type.</p>
                        </div>
                    </div>
                    
                    <!-- Tank Visualization -->
                    <div class="tank-container">
                        <div class="tank-visualization">
                            <div class="tank-level" style="height: 75%"></div>
                            <div class="alert-level-indicator">
                                <div class="alert-level-line"></div>
                            </div>
                        </div>
                        <div class="tank-info">
                            <p>Water Level: 2.7cm</p>
                            <p>75% Capacity</p>
                        </div>
                    </div>
                </div>
                
                <!-- Critical Metrics -->
                <div class="metrics-grid">
                    <div class="metric-card temperature">
                        <div class="metric-label">Temperature</div>
                        <div class="metric-status">Ok</div>
                        <div class="metric-value" id="temperature-value">20.9°C</div>
                    </div>
                    
                    <div class="metric-card tds">
                        <div class="metric-label">TDS</div>
                        <div class="metric-status high">High</div>
                        <div class="metric-value" id="tds-value">52595 ppm</div>
                    </div>
                    
                    <div class="metric-card ph">
                        <div class="metric-label">pH</div>
                        <div class="metric-status high">High</div>
                        <div class="metric-value" id="ph-value">42.06</div>
                    </div>
                </div>
                
                <!-- Detailed Metrics -->
                <div class="detailed-metrics-panel">
                    <div class="panel-header">
                        <h2>Detailed Metrics</h2>
                    </div>
                    <div class="detailed-metrics-grid">
                        <div class="detailed-metric">
                            <div class="metric-header">
                                <div class="metric-name">Temperature</div>
                                <div class="metric-tag normal">Normal</div>
                            </div>
                            <div class="metric-reading">20.9 °C</div>
                            <div class="metric-scale">
                                <div class="scale-markers">
                                    <span>15°C</span>
                                    <span>21°C</span>
                                    <span>30°C</span>
                                </div>
                                <div class="scale-bar">
                                    <div class="scale-indicator" style="left: 42%"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="detailed-metric">
                            <div class="metric-header">
                                <div class="metric-name">pH Level</div>
                                <div class="metric-tag too-high">Too High</div>
                            </div>
                            <div class="metric-reading">42.06 pH</div>
                            <div class="metric-scale">
                                <div class="scale-markers">
                                    <span>5.5</span>
                                    <span>7.0</span>
                                    <span>8.5</span>
                                </div>
                                <div class="scale-bar">
                                    <div class="scale-indicator" style="left: 100%"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="detailed-metric">
                            <div class="metric-header">
                                <div class="metric-name">ORP</div>
                                <div class="metric-tag suboptimal">Suboptimal</div>
                            </div>
                            <div class="metric-reading">214 mV</div>
                            <div class="metric-scale">
                                <div class="scale-markers">
                                    <span>150mV</span>
                                    <span>350mV</span>
                                    <span>600mV</span>
                                </div>
                                <div class="scale-bar">
                                    <div class="scale-indicator" style="left: 15%"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="detailed-metric">
                            <div class="metric-header">
                                <div class="metric-name">TDS</div>
                                <div class="metric-tag too-high">Too High</div>
                            </div>
                            <div class="metric-reading">52595 ppm</div>
                            <div class="metric-scale">
                                <div class="scale-markers">
                                    <span>50</span>
                                    <span>250</span>
                                    <span>500</span>
                                </div>
                                <div class="scale-bar">
                                    <div class="scale-indicator" style="left: 100%"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="detailed-metric">
                            <div class="metric-header">
                                <div class="metric-name">Conductivity</div>
                                <div class="metric-tag suboptimal">Suboptimal</div>
                            </div>
                            <div class="metric-reading">33.66 μS/cm</div>
                            <div class="metric-scale">
                                <div class="scale-markers">
                                    <span>5</span>
                                    <span>20</span>
                                    <span>40</span>
                                </div>
                                <div class="scale-bar">
                                    <div class="scale-indicator" style="left: 90%"></div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="detailed-metric">
                            <div class="metric-header">
                                <div class="metric-name">Water Level</div>
                                <div class="metric-tag suboptimal">Suboptimal</div>
                            </div>
                            <div class="metric-reading">2.7 cm</div>
                            <div class="metric-scale">
                                <div class="scale-markers">
                                    <span>1cm</span>
                                    <span>5cm</span>
                                    <span>10cm</span>
                                </div>
                                <div class="scale-bar">
                                    <div class="scale-indicator" style="left: 19%"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Quick Actions -->
                <div class="quick-actions-panel">
                    <div class="panel-header">
                        <h2>Quick Actions</h2>
                    </div>
                    <div class="actions-grid">
                        <button class="action-btn start-pump">Start Pump</button>
                        <button class="action-btn toggle-light">Toggle Light</button>
                        <button class="action-btn reset-sensors">Reset Sensors</button>
                        <button class="action-btn settings">Settings</button>
                    </div>
                </div>
                
                <!-- System Status -->
                <div class="status-panel">
                    <div class="panel-header">
                        <h2>System Status</h2>
                    </div>
                    <div class="status-grid">
                        <div class="status-item">
                            <div class="status-label">CPU Load</div>
                            <div class="status-gauge">
                                <div class="gauge-fill" style="width: 32%"></div>
                            </div>
                            <div class="status-value">32%</div>
                        </div>
                        
                        <div class="status-item">
                            <div class="status-label">Memory</div>
                            <div class="status-gauge">
                                <div class="gauge-fill" style="width: 45%"></div>
                            </div>
                            <div class="status-value">45%</div>
                        </div>
                        
                        <div class="status-item">
                            <div class="status-label">Storage</div>
                            <div class="status-gauge">
                                <div class="gauge-fill" style="width: 18%"></div>
                            </div>
                            <div class="status-value">18%</div>
                        </div>
                        
                        <div class="status-item">
                            <div class="status-label">Water Level</div>
                            <div class="status-gauge">
                                <div class="gauge-fill water" style="width: 75%"></div>
                            </div>
                            <div class="status-value">2.7cm</div>
                        </div>
                    </div>
                </div>
                
                <!-- Sensor Trends -->
                <div class="sensor-trends-panel">
                    <div class="panel-header">
                        <h2>Sensor Trends</h2>
                        <div class="time-controls">
                            <button class="time-btn active">24 Hours</button>
                            <button class="time-btn">Week</button>
                            <button class="time-btn">Month</button>
                        </div>
                    </div>
                    <div class="trends-container">
                        <!-- Chart will be inserted here by JavaScript -->
                        <div id="trends-chart" class="trends-chart"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Lazy-load Chart.js only when needed -->
    <script src="/static/js/chart.min.js" defer></script>
    <script src="/static/js/dashboard.js"></script>
    <script>
        // Mobile sidebar toggle
        document.getElementById('mobile-toggle').addEventListener('click', function() {
            document.querySelector('.sidebar').classList.toggle('active');
        });

        // Simulate sensor data for chart (in real application this would be from API)
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize chart if the element exists
            if (document.getElementById('trends-chart')) {
                // Sample data setup for pH, EC and Temperature
                const ctx = document.getElementById('trends-chart').getContext('2d');
                
                // Mock data
                const labels = Array.from({length: 24}, (_, i) => `${i}:00`);
                const temperatureData = Array.from({length: 24}, () => Math.random() * 5 + 18);
                const phData = Array.from({length: 24}, () => Math.random() * 2 + 6);
                const ecData = Array.from({length: 24}, () => Math.random() * 20 + 20);
                
                // Chart configuration
                new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [
                            {
                                label: 'Temperature (°C)',
                                data: temperatureData,
                                borderColor: '#4e73df',
                                backgroundColor: 'rgba(78, 115, 223, 0.1)',
                                tension: 0.4,
                                borderWidth: 2,
                                fill: false
                            },
                            {
                                label: 'pH',
                                data: phData,
                                borderColor: '#e74a3b',
                                backgroundColor: 'rgba(231, 74, 59, 0.1)',
                                tension: 0.4,
                                borderWidth: 2,
                                fill: false
                            },
                            {
                                label: 'EC (μS/cm)',
                                data: ecData,
                                borderColor: '#36b9cc',
                                backgroundColor: 'rgba(54, 185, 204, 0.1)',
                                tension: 0.4,
                                borderWidth: 2,
                                fill: false
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'top',
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: false,
                                grid: {
                                    color: 'rgba(0, 0, 0, 0.05)'
                                }
                            },
                            x: {
                                grid: {
                                    display: false
                                }
                            }
                        }
                    }
                });
            }
        });
    </script>
</body>
</html>